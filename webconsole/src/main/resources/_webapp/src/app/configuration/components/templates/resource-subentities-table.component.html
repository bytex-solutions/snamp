<!-- Modal for entity appending -->
<div class="modal fade" id="editEntity{{entityType}}" tabindex="-1" role="dialog" aria-labelledby="editEntityLabel">
    <div class="modal-dialog modal-xlg modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title leftAlign" id="editEntityLabel">Edit {{activeEntity.getName()}} {{activeEntity.name}} for resource {{resourceName}}</h4>
            </div>
            <br/>
            <div class="modal-body">
              <div id="smartwizard{{entityType}}" style="height: 95%">
                <ul>
                      <li>
                        <a [attr.href]="'#name'">
                          Name<br />
                          <small>Name of {{activeEntity.getName()}}</small>
                        </a>
                      </li>
                      <li>
                        <a [attr.href]="'#additional'">
                          Additional<br />
                          <small>Additional {{activeEntity.getName()}}-related members</small>
                        </a>
                      </li>
                      <li>
                        <a [attr.href]="'#parameters'">
                          Parameters<br />
                          <small>Parameters for {{activeEntity.getName()}}</small>
                        </a>
                      </li>
                      <li>
                        <a [attr.href]="'#save'">
                          Save<br />
                          <small>Saving the {{activeEntity.getName()}}</small>
                        </a>
                      </li>
                </ul>

                <div style="height:100%">
                  <div id="name" class="row" style="margin-top: 100px;">
                    <div class="item form-group">
                      <label
                        class="control-label col-md-3 col-sm-3 col-xs-12"
                        for="nameInput"
                        style="margin-top: 7px;">
                          Name <span class="required">*</span>
                      </label>
                      <div class="col-md-6 col-sm-6 col-xs-12">
                        <input
                          id="nameInput"
                          class="form-control col-md-7 col-xs-12"
                          [tooltip]="'At least 4 symbols'"
                          placeholder="input the name of {{activeEntity.getName()}}"
                          [(ngModel)]="activeEntity.name">
                      </div>
                    </div>
                  </div>
                  <div id="additional" class="row" style="margin-top: 100px;">
                    <!-- input for operation -->
                    <div class="item form-group" *ngIf="entityType == 'operation'">
                      <label
                        class="control-label col-md-3 col-sm-3 col-xs-12"
                        for="invtoInput"
                        style="margin-top: 7px;">
                          Invocation timeout <span class="required">*</span>
                      </label>
                      <div class="col-md-6 col-sm-6 col-xs-12">
                        <input
                          id="invtoInput"
                          class="form-control col-md-7 col-xs-12"
                          [tooltip]="'Input number (0 for infinite)'"
                          placeholder="input the invocation timeout of {{activeEntity.getName()}}"
                          [(ngModel)]="activeEntity.invokto">
                      </div>
                    </div>

                    <!-- input for attribute -->
                    <div class="item form-group" *ngIf="entityType == 'attribute'">
                      <label
                        class="control-label col-md-3 col-sm-3 col-xs-12"
                        for="rwtoInput"
                        style="margin-top: 7px;">
                          Read/write timeout <span class="required">*</span>
                      </label>
                      <div class="col-md-6 col-sm-6 col-xs-12">
                        <input
                          id="rwtoInput"
                          class="form-control col-md-7 col-xs-12"
                          [tooltip]="'Input number (0 for infinite)'"
                          placeholder="input the read/write timeout of {{activeEntity.getName()}}"
                          [(ngModel)]="activeEntity.rwto">
                      </div>
                    </div>
                  </div>


                  <!-- PARAMETERS -->
                  <div id="parameters" class="row" style="margin-top: 10px;">
                    <div class="col-md-12" id="tableParamsRow{{entityType}}">
                       <table class="table">
                          <thead>
                          <tr>
                            <th>#</th>
                            <th>Key</th>
                            <th>Value</th>
                          </tr>
                          </thead>
                          <tbody>
                          <tr *ngFor="let param of activeEntity.parameters">
                            <td>
                              <span
                                class="glyphicon glyphicon-remove-circle btn btn-xs btn-danger"
                                (click)="checkAndRemoveParameter(param)"
                                aria-hidden="true">
                              </span>
                            </td>
                            <td>{{param.key}}</td>
                            <td>
                              <inline-edit [(ngModel)]="param.value"
                                           [ngModelOptions]="{standalone: true}"
                                           (onSave)="saveParameter(param)"
                                           [uniqueKey]="param.key">
                              </inline-edit>
                            </td>
                          </tr>
                          <tr>
                            <td></td>
                            <td></td>
                            <td align="right">
                              <button
                                type="button"
                                class="btn btn-primary btn-sm"
                                (click)="addNewParameter()">
                                Add new <i class="fa fa-caret-down" aria-hidden="true"></i>
                              </button>
                            </td>
                          </tr>
                          </tbody>
                      </table>
                    </div>

                    <div class="col-md-12" style="display: none;" id="newParamRow{{entityType}}">
                      <div class="row">
                        <select
                                id="newParamSelect{{entityType}}"
                                [(ngModel)]="currentNewParam.key"
                                style="height: auto;"
                                class="select2_group form-control col-md-4">
                          <optgroup label="Custom parameter">
                            <option value="custom">Append your own param</option>
                          </optgroup>
                          <optgroup label="Suggested parameter" *ngIf="activeEntity.paramDescriptors && activeEntity.paramDescriptors.length > 0">
                            <option
                              *ngFor="let descriptor of activeEntity.paramDescriptors"
                              [attr.required]="descriptor.required"
                              [attr.pattern]="descriptor.pattern"
                              [attr.defaultValue]="descriptor.defaultValue"
                              [value]="descriptor.name">
                              {{descriptor.name}}
                            </option>
                          </optgroup>
                        </select>
                      </div>
                      <div class="row">
                        <div class="col-md-2 col-offset-md-8">
                          <button class="btn btn-primary" (click)="cancelAppendingParam()">
                             Cancel
                          </button>
                          <button class="btn" (click)="appendParameter()">
                            Append parameter
                          </button>
                        </div>
                      </div>
                    </div>

                  </div>
                  <!-- PARAMETERS -->


                  <div id="save" class="row" style="margin-top: 100px;">
                    <button
                      type="button"
                      class="btn btn-primary"
                      [disabled]="readyForSave == false"
                      (click)="saveEntity()">
                      Save changes
                    </button>
                  </div>
                </div>
              </div>
            </div>
           <!-- <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
            </div>-->
        </div>
    </div>
</div>

<table class="table">
    <thead>
    <tr>
        <th>Name</th>
        <th>Actions</th>
    </tr>
    </thead>
    <tbody>
    <tr *ngFor="let entity of entities">

        <td>{{entity.name}}</td>
        <td>
            <div class="btn-group" role="group">
                <button
                        type="button"
                        data-toggle="modal"
                        (click)="setEntity(entity)"
                        [attr.data-target]="'#editEntity' + entityType"
                        class="btn btn-default btn-xs">
                    Edit
                </button>
                <button type="button" class="btn btn-default btn-xs" (click)="remove(entity)">Remove</button>
            </div>
        </td>
    </tr>
    <tr>
      <td></td>
      <td>
        <button
          type="button"
          data-toggle="modal"
          (click)="addNewEntity()"
          [attr.data-target]="'#editEntity' + entityType"
          class="btn btn-default btn-xs">
          Add new
        </button>
      </td>
    </tr>
    </tbody>
</table>
